<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:camunda="http://camunda.org/schema/1.0/bpmn" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" id="Definitions_1qqhzy1" targetNamespace="http://bpmn.io/schema/bpmn" exporter="Camunda Modeler" exporterVersion="4.0.0">
  <bpmn:process id="Process_10ll4dk" name="Embedded Collect Applications Test" isExecutable="true">
    <bpmn:subProcess id="Activity_0a819tr" name="wait for applications">
      <bpmn:incoming>Flow_1y1ssb1</bpmn:incoming>
      <bpmn:outgoing>Flow_126koio</bpmn:outgoing>
      <bpmn:subProcess id="Activity_1818egi" name="collect applications" triggeredByEvent="true">
        <bpmn:serviceTask id="Activity_068sywm" name="check client entry" implementation="##WebService" camunda:class="org.example.delegate.CheckClientEntryDelegate">
          <bpmn:incoming>Flow_0vv3nt2</bpmn:incoming>
          <bpmn:outgoing>Flow_1sfjyrp</bpmn:outgoing>
          <bpmn:dataOutputAssociation id="DataOutputAssociation_183p28y">
            <bpmn:targetRef>DataStoreReference_1n5j0tq</bpmn:targetRef>
          </bpmn:dataOutputAssociation>
        </bpmn:serviceTask>
        <bpmn:exclusiveGateway id="Gateway_1jwr8uz" name="candidate already exist?" gatewayDirection="Diverging">
          <bpmn:incoming>Flow_1sfjyrp</bpmn:incoming>
          <bpmn:outgoing>Flow_1pxailk</bpmn:outgoing>
          <bpmn:outgoing>Flow_0n15s14</bpmn:outgoing>
        </bpmn:exclusiveGateway>
        <bpmn:serviceTask id="Activity_0mzx8ih" name="add to database" implementation="##WebService" camunda:class="org.example.delegate.AddToDatabaseDelegate">
          <bpmn:incoming>Flow_1pxailk</bpmn:incoming>
          <bpmn:outgoing>Flow_1xh7a3d</bpmn:outgoing>
          <bpmn:dataOutputAssociation id="DataOutputAssociation_091ksyq">
            <bpmn:targetRef>DataStoreReference_0ht9mqt</bpmn:targetRef>
          </bpmn:dataOutputAssociation>
        </bpmn:serviceTask>
        <bpmn:serviceTask id="Activity_0yb49at" name="update database record" implementation="##WebService" camunda:class="org.example.delegate.UpdateDatabseRecordDelegate">
          <bpmn:incoming>Flow_0n15s14</bpmn:incoming>
          <bpmn:outgoing>Flow_0fxz8qo</bpmn:outgoing>
          <bpmn:dataOutputAssociation id="DataOutputAssociation_1oln0r0">
            <bpmn:targetRef>DataStoreReference_1n6e2w8</bpmn:targetRef>
          </bpmn:dataOutputAssociation>
        </bpmn:serviceTask>
        <bpmn:exclusiveGateway id="Gateway_0h4wf1x" name="" gatewayDirection="Converging">
          <bpmn:incoming>Flow_0fxz8qo</bpmn:incoming>
          <bpmn:incoming>Flow_1xh7a3d</bpmn:incoming>
          <bpmn:outgoing>Flow_12ctzkl</bpmn:outgoing>
        </bpmn:exclusiveGateway>
        <bpmn:endEvent id="Event_0k1splk" name="">
          <bpmn:incoming>Flow_1bqa2d1</bpmn:incoming>
        </bpmn:endEvent>
        <bpmn:dataStoreReference id="DataStoreReference_1n6e2w8" name="client database" />
        <bpmn:dataStoreReference id="DataStoreReference_0ht9mqt" name="client database" />
        <bpmn:dataStoreReference id="DataStoreReference_1n5j0tq" name="client database" />
        <bpmn:sequenceFlow id="Flow_1bqa2d1" name="" sourceRef="Activity_19adgpl" targetRef="Event_0k1splk" />
        <bpmn:sequenceFlow id="Flow_12ctzkl" name="" sourceRef="Gateway_0h4wf1x" targetRef="Activity_19adgpl" />
        <bpmn:sequenceFlow id="Flow_0fxz8qo" name="" sourceRef="Activity_0yb49at" targetRef="Gateway_0h4wf1x" />
        <bpmn:sequenceFlow id="Flow_1xh7a3d" name="" sourceRef="Activity_0mzx8ih" targetRef="Gateway_0h4wf1x" />
        <bpmn:sequenceFlow id="Flow_1pxailk" name="no" sourceRef="Gateway_1jwr8uz" targetRef="Activity_0mzx8ih">
          <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">#{not CandidateAlreadyExists}</bpmn:conditionExpression>
        </bpmn:sequenceFlow>
        <bpmn:sequenceFlow id="Flow_0n15s14" name="yes" sourceRef="Gateway_1jwr8uz" targetRef="Activity_0yb49at">
          <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">#{CandidateAlreadyExists}</bpmn:conditionExpression>
        </bpmn:sequenceFlow>
        <bpmn:sequenceFlow id="Flow_1sfjyrp" name="" sourceRef="Activity_068sywm" targetRef="Gateway_1jwr8uz" />
        <bpmn:sequenceFlow id="Flow_0vv3nt2" sourceRef="Event_0gttcpk" targetRef="Activity_068sywm" />
        <bpmn:startEvent id="Event_0gttcpk" isInterrupting="false">
          <bpmn:outgoing>Flow_0vv3nt2</bpmn:outgoing>
          <bpmn:messageEventDefinition id="MessageEventDefinition_0zy86r3" messageRef="Message_0drn1mo" />
        </bpmn:startEvent>
        <bpmn:serviceTask id="Activity_19adgpl" name="send confirmation">
          <bpmn:extensionElements>
            <camunda:connector>
              <camunda:inputOutput>
                <camunda:inputParameter name="to">
                  <camunda:script scriptFormat="JavaScript">{"to": execution.getVariable("candidate_confirmation_text")}</camunda:script>
                </camunda:inputParameter>
                <camunda:inputParameter name="subject">Your application has been received</camunda:inputParameter>
                <camunda:inputParameter name="text">
                  <camunda:script scriptFormat="JavaScript">{"to": execution.getVariable("candidate_confirmation_text")}</camunda:script>
                </camunda:inputParameter>
              </camunda:inputOutput>
              <camunda:connectorId>mail-send</camunda:connectorId>
            </camunda:connector>
          </bpmn:extensionElements>
          <bpmn:incoming>Flow_12ctzkl</bpmn:incoming>
          <bpmn:outgoing>Flow_1bqa2d1</bpmn:outgoing>
        </bpmn:serviceTask>
      </bpmn:subProcess>
      <bpmn:startEvent id="Event_1awcz7c" name="ApplicationPhaseStarted">
        <bpmn:outgoing>Flow_0522a8q</bpmn:outgoing>
      </bpmn:startEvent>
      <bpmn:endEvent id="Event_1oe4y8a" name="ApplicationPhase ended">
        <bpmn:incoming>Flow_0njuwm5</bpmn:incoming>
      </bpmn:endEvent>
      <bpmn:sequenceFlow id="Flow_0522a8q" sourceRef="Event_1awcz7c" targetRef="Event_09rtqsi" />
      <bpmn:intermediateCatchEvent id="Event_09rtqsi" name="Deadline exceeded">
        <bpmn:incoming>Flow_0522a8q</bpmn:incoming>
        <bpmn:outgoing>Flow_0njuwm5</bpmn:outgoing>
        <bpmn:timerEventDefinition id="TimerEventDefinition_0j6mhxp">
          <bpmn:timeDuration xsi:type="bpmn:tFormalExpression">PT3M</bpmn:timeDuration>
        </bpmn:timerEventDefinition>
      </bpmn:intermediateCatchEvent>
      <bpmn:sequenceFlow id="Flow_0njuwm5" sourceRef="Event_09rtqsi" targetRef="Event_1oe4y8a" />
    </bpmn:subProcess>
    <bpmn:startEvent id="Event_003w580">
      <bpmn:outgoing>Flow_1y1ssb1</bpmn:outgoing>
    </bpmn:startEvent>
    <bpmn:sequenceFlow id="Flow_1y1ssb1" sourceRef="Event_003w580" targetRef="Activity_0a819tr" />
    <bpmn:sequenceFlow id="Flow_126koio" sourceRef="Activity_0a819tr" targetRef="Activity_1fm2kjy" />
    <bpmn:userTask id="Activity_1fm2kjy" name="test is process ending?">
      <bpmn:incoming>Flow_126koio</bpmn:incoming>
      <bpmn:outgoing>Flow_137ndak</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:endEvent id="Event_08au9hg">
      <bpmn:incoming>Flow_137ndak</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:sequenceFlow id="Flow_137ndak" sourceRef="Activity_1fm2kjy" targetRef="Event_08au9hg" />
  </bpmn:process>
  <bpmn:message id="Message_0drn1mo" name="ApplicationReceivedx" />
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Process_10ll4dk">
      <bpmndi:BPMNEdge id="Flow_137ndak_di" bpmnElement="Flow_137ndak">
        <di:waypoint x="1370" y="285" />
        <di:waypoint x="1452" y="285" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_126koio_di" bpmnElement="Flow_126koio">
        <di:waypoint x="1170" y="285" />
        <di:waypoint x="1270" y="285" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1y1ssb1_di" bpmnElement="Flow_1y1ssb1">
        <di:waypoint x="168" y="300" />
        <di:waypoint x="240" y="300" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="Activity_0a819tr_di" bpmnElement="Activity_0a819tr" isExpanded="true">
        <dc:Bounds x="240" y="110" width="930" height="350" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Flow_0njuwm5_di" bpmnElement="Flow_0njuwm5">
        <di:waypoint x="360" y="318" />
        <di:waypoint x="360" y="372" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0522a8q_di" bpmnElement="Flow_0522a8q">
        <di:waypoint x="360" y="218" />
        <di:waypoint x="360" y="282" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="Activity_1818egi_di" bpmnElement="Activity_1818egi" isExpanded="true">
        <dc:Bounds x="420" y="130" width="650" height="300" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Flow_0vv3nt2_di" bpmnElement="Flow_0vv3nt2">
        <di:waypoint x="478" y="291" />
        <di:waypoint x="514" y="291" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1sfjyrp_di" bpmnElement="Flow_1sfjyrp">
        <di:waypoint x="614" y="291" />
        <di:waypoint x="623" y="291" />
        <di:waypoint x="623" y="292" />
        <di:waypoint x="632" y="292" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0n15s14_di" bpmnElement="Flow_0n15s14">
        <di:waypoint x="652" y="310" />
        <di:waypoint x="652" y="359" />
        <di:waypoint x="696" y="359" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="659" y="329" width="17" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1pxailk_di" bpmnElement="Flow_1pxailk">
        <di:waypoint x="652" y="272" />
        <di:waypoint x="652" y="230" />
        <di:waypoint x="696" y="230" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="653" y="238" width="13" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1xh7a3d_di" bpmnElement="Flow_1xh7a3d">
        <di:waypoint x="796" y="230" />
        <di:waypoint x="829" y="230" />
        <di:waypoint x="829" y="271" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0fxz8qo_di" bpmnElement="Flow_0fxz8qo">
        <di:waypoint x="796" y="360" />
        <di:waypoint x="829" y="360" />
        <di:waypoint x="829" y="311" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_12ctzkl_di" bpmnElement="Flow_12ctzkl">
        <di:waypoint x="849" y="291" />
        <di:waypoint x="894" y="291" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1bqa2d1_di" bpmnElement="Flow_1bqa2d1">
        <di:waypoint x="994" y="291" />
        <di:waypoint x="1016" y="291" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="Activity_068sywm_di" bpmnElement="Activity_068sywm">
        <dc:Bounds x="514" y="251" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_1jwr8uz_di" bpmnElement="Gateway_1jwr8uz" isMarkerVisible="true">
        <dc:Bounds x="631" y="271" width="40" height="40" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="698" y="283" width="88" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0mzx8ih_di" bpmnElement="Activity_0mzx8ih">
        <dc:Bounds x="696" y="191" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0yb49at_di" bpmnElement="Activity_0yb49at">
        <dc:Bounds x="696" y="320" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_0h4wf1x_di" bpmnElement="Gateway_0h4wf1x" isMarkerVisible="true">
        <dc:Bounds x="809" y="271" width="40" height="40" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_0k1splk_di" bpmnElement="Event_0k1splk">
        <dc:Bounds x="1016" y="277" width="28" height="28" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="DataStoreReference_1n6e2w8_di" bpmnElement="DataStoreReference_1n6e2w8">
        <dc:Bounds x="519" y="350" width="62" height="60" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="513" y="415" width="74" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="DataStoreReference_0ht9mqt_di" bpmnElement="DataStoreReference_0ht9mqt">
        <dc:Bounds x="899" y="170" width="62" height="60" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="894" y="149" width="74" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="DataStoreReference_1n5j0tq_di" bpmnElement="DataStoreReference_1n5j0tq">
        <dc:Bounds x="533" y="160" width="62" height="60" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="527" y="136" width="74" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_1oq7107_di" bpmnElement="Event_0gttcpk">
        <dc:Bounds x="442" y="273" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_089e9q8_di" bpmnElement="Activity_19adgpl">
        <dc:Bounds x="894" y="251" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_1awcz7c_di" bpmnElement="Event_1awcz7c">
        <dc:Bounds x="342" y="182" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="317" y="144.5" width="85" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_1oe4y8a_di" bpmnElement="Event_1oe4y8a">
        <dc:Bounds x="342" y="372" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="318" y="415" width="85" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_17nuy68_di" bpmnElement="Event_09rtqsi">
        <dc:Bounds x="342" y="282" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="264" y="290" width="48" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_003w580_di" bpmnElement="Event_003w580">
        <dc:Bounds x="132" y="282" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1dxk60y_di" bpmnElement="Activity_1fm2kjy">
        <dc:Bounds x="1270" y="245" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_08au9hg_di" bpmnElement="Event_08au9hg">
        <dc:Bounds x="1452" y="267" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="DataOutputAssociation_183p28y_di" bpmnElement="DataOutputAssociation_183p28y">
        <di:waypoint x="564" y="251" />
        <di:waypoint x="564" y="220" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="DataOutputAssociation_091ksyq_di" bpmnElement="DataOutputAssociation_091ksyq">
        <di:waypoint x="796" y="223" />
        <di:waypoint x="899" y="206" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="DataOutputAssociation_1oln0r0_di" bpmnElement="DataOutputAssociation_1oln0r0">
        <di:waypoint x="696" y="365" />
        <di:waypoint x="581" y="377" />
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>
